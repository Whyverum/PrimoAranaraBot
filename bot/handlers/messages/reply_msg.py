from random import choice
from typing import List
from aiogram import Router
from aiogram.fsm.context import FSMContext
from aiogram.types import Message

router: Router = Router(name="reply_router")

RANDOM_PHRASES: List[str] = [
    "–ë–ª–∞-–±–ª–∞-–±–ª–∞!", "–•–≤–∞-–∞-–∞-—Ç–∏—Ç!", "–°–µ—Ä—å—ë–∑–Ω–æ? üòè", "–û–ø—è—Ç—å —Ç—ã —ç—Ç–æ –≥–æ–≤–æ—Ä–∏—à—å...",
    "–•–∏-—Ö–∏, —Å–º–µ—à–Ω–æ –∂–µ!", "–¢—ã —Å–Ω–æ–≤–∞ —à—É—Ç–Ω–∏–∫?", "–Ø —É–∂–µ —Å–ª—ã—à–∞–ª —ç—Ç–æ —Ä–∞–Ω—å—à–µ!", "–≠–π, –Ω–µ –Ω–∞–¥–æ —Ç–∞–∫!",
    "–õ–∞–¥–Ω–æ, –ª–∞–¥–Ω–æ, —Ö–≤–∞—Ç–∏—Ç!", "–•–º–º... –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ...", "–¢—ã –º–µ–Ω—è —É–¥–∏–≤–ª—è–µ—à—å!", "–ê –¥–∞–≤–∞–π –ª—É—á—à–µ —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ?",
    "–ù–µ –º–æ–≥—É –ø–æ–≤–µ—Ä–∏—Ç—å!", "–ê—Ö–∞—Ö–∞, —ç—Ç–æ –∑–∞–±–∞–≤–Ω–æ!", "–°–µ—Ä—å—ë–∑–Ω–æ? –ù—É –ª–∞–¥–Ω–æ...", "–≠–π, —ç—Ç–æ —É–∂–µ —Å–ª–∏—à–∫–æ–º!",
    "–û, —ç—Ç–æ –±—ã–ª–æ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ!",
]


@router.message()
async def reply_message(message: Message, state: FSMContext) -> None:
    # –î–æ—Å—Ç–∞—ë–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    data = await state.get_data()
    last_bot_text = data.get("last_bot_text", "")

    # –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –ø—É—Å—Ç–æ–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞.
    # –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—É—Å—Ç–æ–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞), —Ç–æ –º—ã –ù–ï –¥–æ–ª–∂–Ω—ã —Å—á–∏—Ç–∞—Ç—å,
    if last_bot_text and message.text and message.text.strip() == last_bot_text.strip():
        response = "–ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –∑–∞ –º–Ω–æ–π!"
    else:
        response = choice(RANDOM_PHRASES)

    ids = message.message_id-1
    print(str())

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –∏ –ü–û–õ–£–ß–ê–ï–ú –û–ë–™–ï–ö–¢ –û–¢–ü–†–ê–í–õ–ï–ù–ù–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø
    sent_message = await message.reply(response)

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    # –¢–µ–ø–µ—Ä—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞
    await state.update_data(last_bot_text=sent_message.text)